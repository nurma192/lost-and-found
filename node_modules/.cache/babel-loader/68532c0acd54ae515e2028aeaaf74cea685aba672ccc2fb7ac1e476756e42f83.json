{"ast":null,"code":"//\n// Main\n//\nexport function memoize(fn, options) {\n  var cache = options && options.cache ? options.cache : cacheDefault;\n  var serializer = options && options.serializer ? options.serializer : serializerDefault;\n  var strategy = options && options.strategy ? options.strategy : strategyDefault;\n  return strategy(fn, {\n    cache: cache,\n    serializer: serializer\n  });\n}\n//\n// Strategy\n//\nfunction isPrimitive(value) {\n  return value == null || typeof value === 'number' || typeof value === 'boolean'; // || typeof value === \"string\" 'unsafe' primitive for our needs\n}\nfunction monadic(fn, cache, serializer, arg) {\n  var cacheKey = isPrimitive(arg) ? arg : serializer(arg);\n  var computedValue = cache.get(cacheKey);\n  if (typeof computedValue === 'undefined') {\n    computedValue = fn.call(this, arg);\n    cache.set(cacheKey, computedValue);\n  }\n  return computedValue;\n}\nfunction variadic(fn, cache, serializer) {\n  var args = Array.prototype.slice.call(arguments, 3);\n  var cacheKey = serializer(args);\n  var computedValue = cache.get(cacheKey);\n  if (typeof computedValue === 'undefined') {\n    computedValue = fn.apply(this, args);\n    cache.set(cacheKey, computedValue);\n  }\n  return computedValue;\n}\nfunction assemble(fn, context, strategy, cache, serialize) {\n  return strategy.bind(context, fn, cache, serialize);\n}\nfunction strategyDefault(fn, options) {\n  var strategy = fn.length === 1 ? monadic : variadic;\n  return assemble(fn, this, strategy, options.cache.create(), options.serializer);\n}\nfunction strategyVariadic(fn, options) {\n  return assemble(fn, this, variadic, options.cache.create(), options.serializer);\n}\nfunction strategyMonadic(fn, options) {\n  return assemble(fn, this, monadic, options.cache.create(), options.serializer);\n}\n//\n// Serializer\n//\nvar serializerDefault = function () {\n  return JSON.stringify(arguments);\n};\n//\n// Cache\n//\nfunction ObjectWithoutPrototypeCache() {\n  this.cache = Object.create(null);\n}\nObjectWithoutPrototypeCache.prototype.get = function (key) {\n  return this.cache[key];\n};\nObjectWithoutPrototypeCache.prototype.set = function (key, value) {\n  this.cache[key] = value;\n};\nvar cacheDefault = {\n  create: function create() {\n    // @ts-ignore\n    return new ObjectWithoutPrototypeCache();\n  }\n};\nexport var strategies = {\n  variadic: strategyVariadic,\n  monadic: strategyMonadic\n};","map":{"version":3,"names":["memoize","fn","options","cache","cacheDefault","serializer","serializerDefault","strategy","strategyDefault","isPrimitive","value","monadic","arg","cacheKey","computedValue","get","call","set","variadic","args","Array","prototype","slice","arguments","apply","assemble","context","serialize","bind","length","create","strategyVariadic","strategyMonadic","JSON","stringify","ObjectWithoutPrototypeCache","Object","key","strategies"],"sources":["../index.ts"],"sourcesContent":[null],"mappings":"AAAA;AACA;AACA;AAkCA,OAAM,SAAUA,OAAOA,CAAiBC,EAAK,EAAEC,OAAoB;EACjE,IAAMC,KAAK,GAAGD,OAAO,IAAIA,OAAO,CAACC,KAAK,GAAGD,OAAO,CAACC,KAAK,GAAGC,YAAY;EAErE,IAAMC,UAAU,GACdH,OAAO,IAAIA,OAAO,CAACG,UAAU,GAAGH,OAAO,CAACG,UAAU,GAAGC,iBAAiB;EAExE,IAAMC,QAAQ,GACZL,OAAO,IAAIA,OAAO,CAACK,QAAQ,GAAGL,OAAO,CAACK,QAAQ,GAAGC,eAAe;EAElE,OAAOD,QAAQ,CAACN,EAAE,EAAE;IAClBE,KAAK,EAAAA,KAAA;IACLE,UAAU,EAAAA;GACX,CAAC;AACJ;AAEA;AACA;AACA;AAEA,SAASI,WAAWA,CAACC,KAAU;EAC7B,OACEA,KAAK,IAAI,IAAI,IAAI,OAAOA,KAAK,KAAK,QAAQ,IAAI,OAAOA,KAAK,KAAK,SAAS,CACzE,CAAC;AACJ;AAUA,SAASC,OAAOA,CAEdV,EAAK,EACLE,KAA0C,EAC1CE,UAAsB,EACtBO,GAAQ;EAER,IAAMC,QAAQ,GAAGJ,WAAW,CAACG,GAAG,CAAC,GAAGA,GAAG,GAAGP,UAAU,CAACO,GAAG,CAAC;EAEzD,IAAIE,aAAa,GAAGX,KAAK,CAACY,GAAG,CAACF,QAAQ,CAAC;EACvC,IAAI,OAAOC,aAAa,KAAK,WAAW,EAAE;IACxCA,aAAa,GAAGb,EAAE,CAACe,IAAI,CAAC,IAAI,EAAEJ,GAAG,CAAC;IAClCT,KAAK,CAACc,GAAG,CAACJ,QAAQ,EAAEC,aAAa,CAAC;EACpC;EAEA,OAAOA,aAAa;AACtB;AAEA,SAASI,QAAQA,CAEfjB,EAAK,EACLE,KAA0C,EAC1CE,UAAsB;EAEtB,IAAMc,IAAI,GAAGC,KAAK,CAACC,SAAS,CAACC,KAAK,CAACN,IAAI,CAACO,SAAS,EAAE,CAAC,CAAC;EACrD,IAAMV,QAAQ,GAAGR,UAAU,CAACc,IAAI,CAAC;EAEjC,IAAIL,aAAa,GAAGX,KAAK,CAACY,GAAG,CAACF,QAAQ,CAAC;EACvC,IAAI,OAAOC,aAAa,KAAK,WAAW,EAAE;IACxCA,aAAa,GAAGb,EAAE,CAACuB,KAAK,CAAC,IAAI,EAAEL,IAAI,CAAC;IACpChB,KAAK,CAACc,GAAG,CAACJ,QAAQ,EAAEC,aAAa,CAAC;EACpC;EAEA,OAAOA,aAAa;AACtB;AAEA,SAASW,QAAQA,CACfxB,EAAK,EACLyB,OAAgB,EAChBnB,QAAoB,EACpBJ,KAA0C,EAC1CwB,SAAqB;EAErB,OAAOpB,QAAQ,CAACqB,IAAI,CAACF,OAAO,EAAEzB,EAAE,EAAEE,KAAK,EAAEwB,SAAS,CAAC;AACrD;AAEA,SAASnB,eAAeA,CAEtBP,EAAK,EACLC,OAA2B;EAE3B,IAAMK,QAAQ,GAAGN,EAAE,CAAC4B,MAAM,KAAK,CAAC,GAAGlB,OAAO,GAAGO,QAAQ;EAErD,OAAOO,QAAQ,CACbxB,EAAE,EACF,IAAI,EACJM,QAAQ,EACRL,OAAO,CAACC,KAAK,CAAC2B,MAAM,EAAE,EACtB5B,OAAO,CAACG,UAAU,CACnB;AACH;AAEA,SAAS0B,gBAAgBA,CAEvB9B,EAAK,EACLC,OAA2B;EAE3B,OAAOuB,QAAQ,CACbxB,EAAE,EACF,IAAI,EACJiB,QAAQ,EACRhB,OAAO,CAACC,KAAK,CAAC2B,MAAM,EAAE,EACtB5B,OAAO,CAACG,UAAU,CACnB;AACH;AAEA,SAAS2B,eAAeA,CAEtB/B,EAAK,EACLC,OAA2B;EAE3B,OAAOuB,QAAQ,CAACxB,EAAE,EAAE,IAAI,EAAEU,OAAO,EAAET,OAAO,CAACC,KAAK,CAAC2B,MAAM,EAAE,EAAE5B,OAAO,CAACG,UAAU,CAAC;AAChF;AAEA;AACA;AACA;AAEA,IAAMC,iBAAiB,GAAe,SAAAA,CAAA;EACpC,OAAO2B,IAAI,CAACC,SAAS,CAACX,SAAS,CAAC;AAClC,CAAC;AAED;AACA;AACA;AAEA,SAASY,2BAA2BA,CAAA;EAClC,IAAI,CAAChC,KAAK,GAAGiC,MAAM,CAACN,MAAM,CAAC,IAAI,CAAwB;AACzD;AAEAK,2BAA2B,CAACd,SAAS,CAACN,GAAG,GAAG,UAAUsB,GAAW;EAC/D,OAAO,IAAI,CAAClC,KAAK,CAACkC,GAAG,CAAC;AACxB,CAAC;AAEDF,2BAA2B,CAACd,SAAS,CAACJ,GAAG,GAAG,UAC1CoB,GAAW,EACX3B,KAAQ;EAER,IAAI,CAACP,KAAK,CAACkC,GAAG,CAAC,GAAG3B,KAAK;AACzB,CAAC;AAED,IAAMN,YAAY,GAAoB;EACpC0B,MAAM,EAAE,SAASA,MAAMA,CAAA;IACrB;IACA,OAAO,IAAIK,2BAA2B,EAAE;EAC1C;CACD;AAWD,OAAO,IAAMG,UAAU,GAAqB;EAC1CpB,QAAQ,EAAEa,gBAAqC;EAC/CpB,OAAO,EAAEqB;CACV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}